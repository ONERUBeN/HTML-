<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Genesis</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        :root {
            --neon-red: #ff2a6d;
            --neon-blue: #05d9e8;
            --neon-yellow: #f7f052;
            --bg: #01012b;
            --panel: rgba(5, 217, 232, 0.1);
        }

        body {
            background-color: var(--bg);
            color: var(--neon-blue);
            font-family: 'Share Tech Mono', monospace;
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
            background-image: repeating-linear-gradient(0deg, transparent, transparent 1px, #000 1px, #000 2px);
            background-size: 100% 4px;
        }

        /* GLITCH EFFECT */
        .glitch {
            position: relative;
            color: white;
            animation: glitch 1s infinite;
        }
        @keyframes glitch {
            0% { text-shadow: 2px 0 var(--neon-red), -2px 0 var(--neon-blue); }
            100% { text-shadow: -2px 0 var(--neon-red), 2px 0 var(--neon-blue); }
        }

        /* HUD */
        .hud {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            background: rgba(0,0,0,0.8);
            border-bottom: 1px solid var(--neon-blue);
        }
        .bar-container { width: 100px; height: 10px; background: #333; border: 1px solid var(--neon-blue); transform: skewX(-20deg); }
        .bar-fill { width: 70%; height: 100%; background: var(--neon-blue); box-shadow: 0 0 10px var(--neon-blue); }

        /* CONTENT */
        #content { flex: 1; position: relative; perspective: 1000px; display: flex; align-items: center; justify-content: center; }
        
        .card {
            width: 85%; height: 60vh;
            background: #000;
            border: 2px solid var(--neon-red);
            position: absolute;
            display: flex; flex-direction: column;
            box-shadow: 0 0 20px var(--neon-red);
            transition: transform 0.3s;
        }
        .card img { width: 100%; height: 50%; object-fit: cover; filter: grayscale(100%) contrast(1.2); border-bottom: 1px solid var(--neon-red); }
        .card-body { padding: 15px; }
        .rarity { color: var(--neon-yellow); font-size: 20px; text-shadow: 0 0 5px var(--neon-yellow); }

        /* HACKING MINI-GAME */
        #hack-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 100; display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .hack-bar { width: 80%; height: 30px; border: 2px solid #fff; position: relative; overflow: hidden; }
        .hack-zone { position: absolute; left: 40%; width: 20%; height: 100%; background: rgba(0, 255, 0, 0.5); }
        .hack-cursor { position: absolute; left: 0; width: 5px; height: 100%; background: var(--neon-red); animation: moveCursor 1s linear infinite alternate; }
        @keyframes moveCursor { from { left: 0; } to { left: 100%; } }

        /* CONTROLS */
        .controls { padding: 20px; display: flex; gap: 10px; z-index: 10; }
        .btn { flex: 1; height: 50px; background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue); font-family: inherit; font-size: 18px; cursor: pointer; clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%); transition: 0.1s; }
        .btn:active { background: var(--neon-blue); color: #000; }
        .btn-hack { border-color: var(--neon-red); color: var(--neon-red); }

    </style>
</head>
<body>

    <div class="hud">
        <div>
            <div style="font-size:12px;">NETRUNNER</div>
            <div class="bar-container"><div class="bar-fill" id="energy-bar"></div></div>
        </div>
        <div style="text-align:right;">
            <div style="font-size:12px;">CREDITS</div>
            <div class="glitch" style="font-size:18px;">¥ 1,450</div>
        </div>
    </div>

    <div id="content">
        <div class="card" id="current-card">
            <img src="https://img.freepik.com/free-photo/cyberpunk-city-street-night-with-neon-lights_23-2150712265.jpg">
            <div class="card-body">
                <div class="rarity">LEGENDARY SIGNAL</div>
                <h2>APT-404</h2>
                <p>PRICE: ¥ 450</p>
                <div style="font-size:12px; color:#666; margin-top:10px;">ENCRYPTION LEVEL: HARD</div>
            </div>
        </div>
    </div>

    <div id="hack-overlay">
        <h1 class="glitch" style="margin-bottom:20px;">DECRYPTING...</h1>
        <div class="hack-bar">
            <div class="hack-zone"></div>
            <div class="hack-cursor" id="cursor"></div>
        </div>
        <button class="btn" style="margin-top:30px; width:200px;" onclick="stopHack()">STOP</button>
    </div>

    <div class="controls">
        <button class="btn" onclick="nextCard()">SKIP</button>
        <button class="btn btn-hack" onclick="startHack()">HACK (2⚡)</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let isHacking = false;

        function startHack() {
            tg.HapticFeedback.impactOccurred('heavy');
            document.getElementById('hack-overlay').style.display = 'flex';
            isHacking = true;
        }

        function stopHack() {
            if (!isHacking) return;
            isHacking = false;
            
            const cursor = document.getElementById('cursor');
            const zone = document.querySelector('.hack-zone');
            const barWidth = document.querySelector('.hack-bar').offsetWidth;
            
            // Calculate positions
            const curLeft = cursor.getBoundingClientRect().left;
            const zoneLeft = zone.getBoundingClientRect().left;
            const zoneRight = zoneLeft + zone.offsetWidth;
            
            // Check Hit
            if (curLeft >= zoneLeft && curLeft <= zoneRight) {
                success();
            } else {
                fail();
            }
        }

        function success() {
            tg.HapticFeedback.notificationOccurred('success');
            document.querySelector('.glitch').innerText = "ACCESS GRANTED";
            document.querySelector('.glitch').style.color = "#0f0";
            setTimeout(() => {
                document.getElementById('hack-overlay').style.display = 'none';
                tg.sendData(JSON.stringify({action: 'hack_attempt', success: true}));
                tg.showPopup({title: 'SYSTEM', message: 'Owner: +996 555 ...\nSaved to Databank.'});
            }, 1000);
        }

        function fail() {
            tg.HapticFeedback.notificationOccurred('error');
            document.querySelector('.glitch').innerText = "ACCESS DENIED";
            document.querySelector('.glitch').style.color = "red";
            setTimeout(() => {
                document.getElementById('hack-overlay').style.display = 'none';
                tg.sendData(JSON.stringify({action: 'hack_attempt', success: false}));
            }, 1000);
        }

        function nextCard() {
            const card = document.getElementById('current-card');
            card.style.transform = "translateX(-200%) rotate(-20deg)";
            setTimeout(() => {
                card.style.transform = "translateX(0) rotate(0)";
                // In real app, load next data here
            }, 500);
        }
    </script>
</body>
</html>
