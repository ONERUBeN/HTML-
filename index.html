<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Omega Terminal</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* CORE */
        :root { --neon: #0f0; --bg: #000; --panel: rgba(0,20,0,0.9); }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Courier New', monospace; overflow: hidden; height: 100vh; }
        
        /* MATRIX CANVAS */
        #matrix { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.3; }

        /* UI LAYOUT */
        .container { display: flex; flex-direction: column; height: 100%; padding: 20px; box-sizing: border-box; }
        
        /* HUD */
        .hud { display: flex; justify-content: space-between; padding: 10px; border: 1px solid var(--neon); box-shadow: 0 0 10px var(--neon); background: var(--panel); border-radius: 5px; }
        .stat { text-align: center; }
        .stat-val { font-size: 18px; font-weight: bold; color: var(--neon); text-shadow: 0 0 5px var(--neon); }
        .stat-lbl { font-size: 10px; color: #888; }

        /* TABS */
        .tabs { display: flex; margin-top: 10px; gap: 10px; }
        .tab { flex: 1; padding: 10px; background: #111; border: 1px solid #333; color: #888; text-align: center; cursor: pointer; transition: 0.3s; }
        .tab.active { border-color: var(--neon); color: var(--neon); box-shadow: 0 0 10px var(--neon); }

        /* CONTENT AREA */
        .content { flex: 1; position: relative; margin-top: 20px; perspective: 1000px; }
        
        /* CARD (3D) */
        .card {
            position: absolute; width: 100%; height: 100%;
            background: #111; border: 1px solid var(--neon); border-radius: 15px;
            overflow: hidden; box-shadow: 0 0 30px rgba(0, 255, 0, 0.1);
            transition: transform 0.3s, opacity 0.3s;
            display: flex; flex-direction: column;
        }
        .card img { width: 100%; height: 60%; object-fit: cover; border-bottom: 1px solid var(--neon); }
        .card-body { padding: 15px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        
        /* RANK BADGE */
        .rank { 
            position: absolute; top: 10px; right: 10px; 
            background: #000; color: var(--neon); border: 1px solid var(--neon);
            padding: 5px 10px; font-weight: bold; box-shadow: 0 0 10px var(--neon);
        }

        /* CONTROLS */
        .controls { display: flex; gap: 20px; margin-top: 20px; height: 70px; }
        .btn { flex: 1; border: 2px solid #333; background: #000; color: #555; font-size: 30px; display: flex; justify-content: center; align-items: center; border-radius: 10px; cursor: pointer; transition: 0.1s; }
        .btn:active { transform: scale(0.95); }
        .btn-yes { border-color: var(--neon); color: var(--neon); }
        .btn-no { border-color: red; color: red; }

        /* SHOP SCREEN */
        #shop-screen { display: none; text-align: center; padding-top: 50px; }
        .product { border: 1px solid #333; padding: 20px; margin-bottom: 20px; border-radius: 10px; }
        .buy-btn { background: var(--neon); color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; margin-top: 10px; }

    </style>
</head>
<body>

    <canvas id="matrix"></canvas>

    <div class="container">
        <div class="hud">
            <div class="stat">
                <div class="stat-val" id="lvl">5</div>
                <div class="stat-lbl">LEVEL</div>
            </div>
            <div class="stat">
                <div class="stat-val" id="energy">‚ö°Ô∏è 8/10</div>
                <div class="stat-lbl">ENERGY</div>
            </div>
            <div class="stat">
                <div class="stat-val">VIP</div>
                <div class="stat-lbl">STATUS</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('radar')">RADAR</div>
            <div class="tab" onclick="switchTab('shop')">MARKET</div>
        </div>

        <div class="content" id="radar-screen">
            <div id="stack"></div>
        </div>

        <div class="content" id="shop-screen">
            <div class="product">
                <h3 style="color:var(--neon)">VIP IMPLANT</h3>
                <p>Unlock Infinite Energy + AI</p>
                <button class="buy-btn" onclick="buy('vip')">BUY (150‚≠ê)</button>
            </div>
            <div class="product">
                <h3 style="color:yellow">BATTERY PACK</h3>
                <p>Restore full energy</p>
                <button class="buy-btn" style="background:yellow" onclick="buy('energy')">BUY (10‚≠ê)</button>
            </div>
        </div>

        <div class="controls" id="controls">
            <div class="btn btn-no" onclick="swipe('left')">‚úñ</div>
            <div class="btn btn-yes" onclick="swipe('right')">üìû</div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // --- MATRIX RAIN EFFECT ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        const chars = '010101XYZA';
        const drops = Array(Math.floor(canvas.width / 20)).fill(1);

        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0f0';
            ctx.font = '15px monospace';
            for (let i = 0; i < drops.length; i++) {
                const text = chars[Math.floor(Math.random() * chars.length)];
                ctx.fillText(text, i * 20, drops[i] * 20);
                if (drops[i] * 20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }
        }
        setInterval(drawMatrix, 50);

        // --- GAME LOGIC ---
        const items = [
            {t: "Penthouse", p: "$1200", i: "https://img.freepik.com/free-photo/luxury-bedroom-suite-resort-high-rise-hotel-with-working-table_105762-2146.jpg", s: 95},
            {t: "Studio", p: "$450", i: "https://img.freepik.com/free-photo/modern-living-room-interior-design_23-2150794665.jpg", s: 78},
            {t: "Old Flat", p: "$300", i: "https://img.freepik.com/free-photo/3d-rendering-loft-luxury-living-room-with-bookshelf_105762-2104.jpg", s: 40}
        ];
        
        let index = 0;

        function renderCard() {
            const stack = document.getElementById('stack');
            stack.innerHTML = '';
            
            if (index >= items.length) {
                stack.innerHTML = '<div style="text-align:center; padding-top:100px;"><h3>NO SIGNALS</h3>Scanning...</div>';
                return;
            }

            const data = items[index];
            const rank = data.s >= 90 ? "S-TIER" : (data.s >= 70 ? "A-TIER" : "B-TIER");
            const color = data.s >= 90 ? "orange" : "#0f0";

            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <div class="rank" style="color:${color}; border-color:${color}; box-shadow:0 0 10px ${color}">${rank}</div>
                <img src="${data.i}">
                <div class="card-body">
                    <h2 style="margin:0">${data.t}</h2>
                    <h1 style="color:${color}; margin:10px 0">${data.p}</h1>
                    <p style="color:#888; font-size:12px;">AI SCORE: ${data.s}/100</p>
                </div>
            `;
            
            // 3D Tilt Effect
            card.addEventListener('mousemove', (e) => {
                const x = (window.innerWidth / 2 - e.pageX) / 20;
                const y = (window.innerHeight / 2 - e.pageY) / 20;
                card.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
            });

            stack.appendChild(card);
        }

        function swipe(dir) {
            const card = document.querySelector('.card');
            if (!card) return;
            
            tg.HapticFeedback.impactOccurred('medium');
            
            const x = dir === 'right' ? 200 : -200;
            const r = dir === 'right' ? 20 : -20;
            
            card.style.transform = `translate(${x}px, 50px) rotate(${r}deg)`;
            card.style.opacity = '0';
            
            if (dir === 'right') {
                tg.showPopup({title: 'SUCCESS', message: 'Owner contacted.'});
            }

            setTimeout(() => {
                index++;
                renderCard();
            }, 300);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            if (tab === 'shop') {
                document.getElementById('radar-screen').style.display = 'none';
                document.getElementById('controls').style.display = 'none';
                document.getElementById('shop-screen').style.display = 'block';
            } else {
                document.getElementById('radar-screen').style.display = 'block';
                document.getElementById('controls').style.display = 'flex';
                document.getElementById('shop-screen').style.display = 'none';
            }
        }

        function buy(item) {
            tg.sendData(JSON.stringify({action: 'buy', item: item}));
        }

        renderCard();
    </script>
</body>
</html>
