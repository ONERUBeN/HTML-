<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Singularity Hub</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* [CORE STYLES] */
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #bc13fe;
            --neon-green: #0aff0a;
            --bg-dark: #050505;
            --glass: rgba(255, 255, 255, 0.05);
        }
        
        @font-face { font-family: 'Cyber'; src: local('Courier New'); }
        
        body {
            background-color: var(--bg-dark);
            color: #fff;
            font-family: 'Cyber', monospace;
            margin: 0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* [BACKGROUND GRID] */
        .grid-bg {
            position: fixed;
            top: 0; left: 0; width: 200vw; height: 200vh;
            background: 
                linear-gradient(rgba(0, 243, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
            animation: gridMove 20s linear infinite;
            z-index: -1;
            pointer-events: none;
        }
        
        @keyframes gridMove { 0% { background-position: 0 0; } 100% { background-position: 0 400px; } }

        /* [HEADER HUD] */
        .hud {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: linear-gradient(180deg, rgba(0,0,0,0.8), transparent);
            z-index: 10;
        }
        
        .xp-bar {
            width: 100px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .xp-fill {
            height: 100%;
            background: var(--neon-pink);
            width: 45%;
            box-shadow: 0 0 10px var(--neon-pink);
        }

        /* [CARD STACK] */
        #viewport {
            flex: 1;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }
        
        .card {
            position: absolute;
            width: 90%;
            max-width: 400px;
            height: 65vh;
            background: #111;
            border: 1px solid var(--neon-blue);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 243, 255, 0.2);
            overflow: hidden;
            transform-style: preserve-3d;
            transition: transform 0.3s ease-out;
            cursor: grab;
        }
        
        .card img {
            width: 100%;
            height: 60%;
            object-fit: cover;
            border-bottom: 1px solid var(--neon-blue);
        }
        
        .card-info { padding: 15px; }
        
        .tag {
            display: inline-block;
            padding: 2px 8px;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            font-size: 10px;
            border-radius: 4px;
            margin-bottom: 5px;
            text-shadow: 0 0 5px var(--neon-green);
        }

        .price { font-size: 24px; font-weight: bold; color: #fff; }

        /* [CONTROLS] */
        .controls {
            display: flex;
            justify-content: space-evenly;
            padding: 20px;
            padding-bottom: 40px;
            z-index: 10;
        }
        
        .btn {
            width: 60px; height: 60px;
            border-radius: 50%;
            border: 2px solid #555;
            background: rgba(0,0,0,0.5);
            color: white;
            font-size: 24px;
            display: flex; align-items: center; justify-content: center;
            transition: 0.2s;
            backdrop-filter: blur(5px);
        }
        
        .btn-x { border-color: var(--neon-pink); color: var(--neon-pink); }
        .btn-h { border-color: var(--neon-green); color: var(--neon-green); }
        
        .btn:active { transform: scale(0.9); }

        /* [LOADING SCREEN] */
        #loader {
            position: fixed; inset: 0; background: #000;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 999;
            transition: opacity 0.5s;
        }
        
        .glitch {
            font-size: 24px; font-weight: bold;
            text-shadow: 2px 0 var(--neon-pink), -2px 0 var(--neon-blue);
            animation: glitch 1s infinite alternate-reverse;
        }
        
        @keyframes glitch { 0% { transform: skew(0deg); } 20% { transform: skew(-10deg); } 40% { transform: skew(10deg); } }

    </style>
</head>
<body>

    <div class="grid-bg"></div>

    <div id="loader">
        <div class="glitch">SINGULARITY</div>
        <div style="margin-top:20px; color:var(--neon-blue); font-size:12px;">INITIALIZING NEURAL NET...</div>
    </div>

    <div class="hud">
        <div>
            <div style="font-size:12px; color:#888;">HUNTER LVL 5</div>
            <div class="xp-bar"><div class="xp-fill"></div></div>
        </div>
        <div style="text-align:right;">
            <div style="font-size:18px; color:var(--neon-blue);">1,240 XP</div>
            <div style="font-size:10px; color:var(--neon-pink);">VIP ACTIVE</div>
        </div>
    </div>

    <div id="viewport">
        </div>

    <div class="controls">
        <div class="btn btn-x" onclick="action('left')">âœ–</div>
        <div class="btn" style="border-color:white;" onclick="buyVip()">ðŸ’Ž</div>
        <div class="btn btn-h" onclick="action('right')">â™¥</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // MOCK DATA (In real version, fetch from API)
        const items = [
            {t: "Penthouse Lux", p: "$1,200", i: "https://img.freepik.com/free-photo/luxury-bedroom-suite-resort-high-rise-hotel-with-working-table_105762-2146.jpg", tag: "LEGENDARY"},
            {t: "Studio Center", p: "$450", i: "https://img.freepik.com/free-photo/3d-rendering-loft-luxury-living-room-with-bookshelf_105762-2104.jpg", tag: "RARE"},
            {t: "Cozy Flat", p: "$300", i: "https://img.freepik.com/free-photo/modern-living-room-interior-design_23-2150794665.jpg", tag: "COMMON"}
        ];

        let index = 0;
        const viewport = document.getElementById('viewport');

        function init() {
            setTimeout(() => {
                document.getElementById('loader').style.opacity = '0';
                setTimeout(() => document.getElementById('loader').remove(), 500);
                renderCard();
            }, 1500);
        }

        function renderCard() {
            viewport.innerHTML = '';
            if (index >= items.length) {
                viewport.innerHTML = '<div style="color:white; text-align:center;"><h2>NO SIGNALS</h2><p>Scanning network...</p></div>';
                tg.sendData(JSON.stringify({action: 'scan_request'}));
                return;
            }

            const item = items[index];
            const card = document.createElement('div');
            card.className = 'card';
            card.innerHTML = `
                <img src="${item.i}">
                <div class="card-info">
                    <span class="tag">${item.tag}</span>
                    <h2 style="margin:5px 0;">${item.t}</h2>
                    <div class="price">${item.p}</div>
                    <p style="font-size:12px; color:#aaa;">
                        AI VERDICT: SAFE<br>
                        DISTANCE: 2.4 KM
                    </p>
                </div>
            `;
            viewport.appendChild(card);
            
            // Add Touch Logic
            let startX = 0;
            card.addEventListener('touchstart', e => startX = e.touches[0].clientX);
            card.addEventListener('touchend', e => {
                const delta = e.changedTouches[0].clientX - startX;
                if (Math.abs(delta) > 50) action(delta > 0 ? 'right' : 'left');
            });
        }

        function action(dir) {
            const card = document.querySelector('.card');
            if (!card) return;

            tg.HapticFeedback.impactOccurred('medium');
            
            const rotate = dir === 'right' ? 20 : -20;
            const translate = dir === 'right' ? 200 : -200;
            
            card.style.transform = `translate(${translate}px, 50px) rotate(${rotate}deg)`;
            card.style.opacity = '0';

            if (dir === 'right') {
                tg.showPopup({
                    title: 'CONTACT',
                    message: 'Owner: +996 555 123 456\n(Saved to history)',
                    buttons: [{type: 'ok'}]
                });
            }

            setTimeout(() => {
                index++;
                renderCard();
            }, 300);
        }

        function buyVip() {
            tg.sendData(JSON.stringify({action: 'buy_vip'}));
        }

        init();
    </script>
</body>
</html>
